#define CONFIG_WIRELESS
#define REAL_POINTING_DEVICE
#define ZMK_BASE_LAYER(name, LT, RT, LM, RM, LB, RB, LH, RH)                   \
    ZMK_LAYER(                                                                 \
        name,                                                                  \
                 LT RT                                                         \
                 LM RM                                                         \
                 LB RB                                                         \
                 LH RH                                                         \
    )

#include <zmk-helpers/key-labels/42.h>
#include <dt-bindings/zmk/matrix_transform.h>

/ {
    chosen {
        zmk,physical-layout = &gggw_crosses_42_layout;
        zmk,matrix-transform = &shifted_transform;
    };

    shifted_transform: keymap_transform0 {
        compatible = "zmk,matrix-transform";
        columns = <12>;
        rows = <5>;
        map = <
            RC(1,0) RC(1,1) RC(1,2) RC(1,3) RC(1,4) RC(1,5)       RC(1,6) RC(1,7) RC(1,8) RC(1,9) RC(1,10) RC(1,11)
            RC(2,0) RC(2,1) RC(2,2) RC(2,3) RC(2,4) RC(2,5)       RC(2,6) RC(2,7) RC(2,8) RC(2,9) RC(2,10) RC(2,11)
            RC(3,0) RC(3,1) RC(3,2) RC(3,3) RC(3,4) RC(3,5)       RC(3,6) RC(3,7) RC(3,8) RC(3,9) RC(3,10) RC(3,11)
                                    RC(4,3) RC(4,4) RC(4,5)       RC(4,6) RC(4,7) RC(4,8)
        >;
    };

    zip_temp_layer: zip_temp_layer {
        compatible = "zmk,input-processor-temp-layer";
        #input-processor-cells = <2>;
    };
};

&gggw_crosses_42_layout {
    transform = <&shifted_transform>;
};

#include "base.keymap"

&mmv_input_listener {
    snipe {
        layers = <MOUSE_SNIPE>;
        input-processors = <&zip_xy_scaler 1 4>;
    };

    hyper {
        layers = <MOUSE_HYPR>;
        input-processors = <&zip_xy_scaler 2 1>;
    };
};

&msc_input_listener {
    snipe {
        layers = <MOUSE_SNIPE>;
        input-processors = <&zip_scroll_scaler 1 2>;
    };

    hyper {
        layers = <MOUSE_HYPR>;
        input-processors = <&zip_scroll_scaler 4 1>;
    };
};
